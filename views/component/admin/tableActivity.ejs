<div class="card mb-3">
    <div class="card-header">
      <i class="fas fa-table"></i>
      ตารางกิจกรรมดำเนินการอยู่
    <div class="card-body">
      <div class="table-responsive">
        <table class="table table-bordered"  width="100%" cellspacing="0">
          <thead>
            <tr>
              <th>วันที่จัด</th>
              <th>รายการ</th>
              <th>รหัส</th>
              <th>คนเข้าร่วม</th>
              <th>คะแนน</th>
              <th>สถานะ</th>
              <th>ตัวเลือก</th>
            </tr>
          </thead>

          <tbody>
            <% listsActivity.map((value, index) => {  %>
              <% if(value.actCode != 'Complete') {%>
            <tr>
              <%  var dd = value.actDate.getDate() 
                  var mm = value.actDate.getMonth() + 1
                  var yyyy = value.actDate.getFullYear()
                  if (dd < 10) {
                    dd = '0' + dd;
                  } 
                  if (mm < 10) {
                    mm = '0' + mm;
                  } 
                 var today = dd + '/' + mm + '/' + yyyy;
              %>
              <td><%= today %></td>
              <td><%= value.actName %></td>
              <% if(value.actCode != 'Complete') { %>
              <td><%= value.actCode %></td>
              <% }else{ %>
                <td style="text-decoration-line: line-through;"></td>
                <%}%>
              <td><%= peopleJoin[value.actId]  ? peopleJoin[value.actId] : '0' %></td>
              <td><%= value.actScore %></td>
              <td> 
                <% if(value.actCode != 'Complete') { %>
                <button class="btn btn-sm btn-success "
                onclick="javascript:return ConfirmDelete(<%=value.actId%>)"
                >ดำเนินการ</button class="btn btn-sm">
                <% }else{ %>
                  <button class="btn btn-sm btn-outline-danger">ยกเลิกแล้ว</button>
                  <%}%>
              <td>
                
                  <button 
                  onclick="javascript:window.location.href='/listJoin/<%= value.actId%>'"
                  class="btn btn-sm btn-secondary "><i class="fas fa-search"></i></button>
                  <button 
                  onclick="javascript:window.location.href='/ManagerActivity/editactivity/<%= value.actId%>'"
                  class="btn btn-sm btn-warning"><i class="fas fa-edit"></i></button>
                  <button 
                  data-toggle="modal" data-target="#DeleteModal<%= index%>"
                  class="btn btn-sm btn-danger"><i class="fas fa-trash"></i></button>
              </td>
            </tr>
            <%}%>
                           <!-- modal -->
                           <div class="modal fade" id="DeleteModal<%= index%>" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
                            aria-hidden="true">
                            <div class="modal-dialog" role="document">
                              <div class="modal-content">
                                <div class="modal-header">
                                  <h5 class="modal-title" id="exampleModalLabel">ต้องการลบใช่ไหม ?</h5>
                                  <button class="close" type="button" data-dismiss="modal" aria-label="Close">
                                    <span aria-hidden="true">×</span>
                                  </button>
                                </div>
                                <div class="modal-body">เลือก"ลบ"เพื่อลบข้อมูลออกจากฐานข้อมูลทั้งหมด</div>
                                <div class="modal-footer">
                                  <button class="btn btn-secondary" type="button" data-dismiss="modal">ยกเลิก</button>
                                  <a class="btn btn-primary" href="/ManagerActivity/delactivity/<%= value.actId %>">ลบ</a>
                                </div>
                              </div>
                            </div>
                          </div>
                          <!-- End modal -->
            <% })%>
          </tbody>
        </table>
      </div>
    </div>
  </div>

</div>

<hr>
<h3>เรียบร้อยแล้ว</h3>


<div class="card mb-3">
  <div class="card-header">
    <i class="fas fa-table"></i>
    ตารางกิจกรรมเรียบร้อยแล้ว
  <div class="card-body">
    <div class="table-responsive">
      <table class="table table-bordered" id="dataTable" width="100%" cellspacing="0">
        <thead>
          <tr>
            <th>วันที่จัด</th>
            <th>รายการ</th>
            <th>รหัส</th>
            <th>คนเข้าร่วม</th>
            <th>คะแนน</th>
            <th>สถานะ</th>
            <th>ตัวเลือก</th>
          </tr>
        </thead>

        <tbody>
          <% listsActivity.map((value, index) => {  %>
            <% if(value.actCode === 'Complete') {%>
          <tr>
            <%  var dd = value.actDate.getDate() 
                var mm = value.actDate.getMonth() + 1
                var yyyy = value.actDate.getFullYear()
                if (dd < 10) {
                  dd = '0' + dd;
                } 
                if (mm < 10) {
                  mm = '0' + mm;
                } 
               var today = dd + '/' + mm + '/' + yyyy;
            %>
            <td><%= today %></td>
            <td><%= value.actName %></td>
            <% if(value.actCode != 'Complete') { %>
            <td><%= value.actCode %></td>
            <% }else{ %>
              <td style="text-decoration-line: line-through;"></td>
              <%}%>
            <td><%= peopleJoin[value.actId]  ? peopleJoin[value.actId] : '0' %></td>
            <td><%= value.actScore %></td>
            <td> 
              <% if(value.actCode != 'Complete') { %>
              <button class="btn btn-sm btn-success "
              onclick="javascript:return ConfirmDelete(<%=value.actId%>)"
              >ดำเนินการ</button class="btn btn-sm">
              <% }else{ %>
                <button class="btn btn-sm btn-outline-danger">ยกเลิกแล้ว</button>
                <%}%>
            <td>
              
                <button 
                onclick="javascript:window.location.href='/listJoin/<%= value.actId%>'"
                class="btn btn-sm btn-secondary "><i class="fas fa-search"></i></button>
                <button 
                onclick="javascript:window.location.href='/ManagerActivity/editactivity/<%= value.actId%>'"
                class="btn btn-sm btn-warning"><i class="fas fa-edit"></i></button>
                <button 
                data-toggle="modal" data-target="#DeleteModal<%= index%>"
                class="btn btn-sm btn-danger"><i class="fas fa-trash"></i></button>
            </td>
          </tr>
          <%}%>
                         <!-- modal -->
                         <div class="modal fade" id="DeleteModal<%= index%>" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
                          aria-hidden="true">
                          <div class="modal-dialog" role="document">
                            <div class="modal-content">
                              <div class="modal-header">
                                <h5 class="modal-title" id="exampleModalLabel">ต้องการลบใช่ไหม ?</h5>
                                <button class="close" type="button" data-dismiss="modal" aria-label="Close">
                                  <span aria-hidden="true">×</span>
                                </button>
                              </div>
                              <div class="modal-body">เลือก"ลบ"เพื่อลบข้อมูลออกจากฐานข้อมูลทั้งหมด</div>
                              <div class="modal-footer">
                                <button class="btn btn-secondary" type="button" data-dismiss="modal">ยกเลิก</button>
                                <a class="btn btn-primary" href="/ManagerActivity/delactivity/<%= value.actId %>">ลบ</a>
                              </div>
                            </div>
                          </div>
                        </div>
                        <!-- End modal -->
          <% })%>
        </tbody>
      </table>
    </div>
  </div>
</div>

</div>


<script>
    function ConfirmDelete(idAct) {
        var x = confirm("ต้องการเปลี่ยนสถานะกิจกรรม?");
        console.log(idAct);
        
        if (x)
            window.location.href = '/activityStatus/'+idAct;
        else
            return false;
    }
</script>